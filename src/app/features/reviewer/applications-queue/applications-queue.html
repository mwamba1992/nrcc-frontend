<app-reviewer-layout>
  <div class="applications-container">
    <!-- Page Header with Clickable Stats -->
    <div class="page-header">
      <div class="header-content">
        <h1>Applications Queue</h1>
        <p class="subtitle">Review and process road reclassification applications</p>
      </div>
      <div class="header-actions">
        <button class="btn-export" (click)="exportToCSV()" title="Export to CSV">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          Export
        </button>
      </div>
    </div>

    <!-- Clickable Status Cards -->
    <div class="status-cards">
      <div class="status-card total"
           [class.active]="selectedFilter() === 'all'"
           (click)="filterByCard('all')"
           title="Click to show all applications">
        <div class="card-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
        </div>
        <div class="card-content">
          <span class="card-count">{{ statusCounts().total }}</span>
          <span class="card-label">Total Applications</span>
        </div>
      </div>

      <div class="status-card pending"
           [class.active]="selectedFilter() === 'pending'"
           (click)="filterByCard('pending')"
           title="Click to filter pending applications">
        <div class="card-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
        </div>
        <div class="card-content">
          <span class="card-count">{{ statusCounts().pending }}</span>
          <span class="card-label">Pending Review</span>
        </div>
      </div>

      <div class="status-card in-progress"
           [class.active]="selectedFilter() === 'in_progress'"
           (click)="filterByCard('in_progress')"
           title="Click to filter in-progress applications">
        <div class="card-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
          </svg>
        </div>
        <div class="card-content">
          <span class="card-count">{{ statusCounts().inProgress }}</span>
          <span class="card-label">In Progress</span>
        </div>
      </div>

      <div class="status-card completed"
           [class.active]="selectedFilter() === 'completed'"
           (click)="filterByCard('completed')"
           title="Click to filter completed applications">
        <div class="card-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
        </div>
        <div class="card-content">
          <span class="card-count">{{ statusCounts().completed }}</span>
          <span class="card-label">Completed</span>
        </div>
      </div>
    </div>

    <!-- Filters Bar -->
    <div class="filters-bar">
      <div class="filters-left">
        <div class="filter-group">
          <label>Status:</label>
          <select [ngModel]="selectedFilter()" (ngModelChange)="filterApplications($event)">
            <option value="all">All Applications</option>
            <option value="pending">Pending Review</option>
            <option value="in_progress">In Progress</option>
            <option value="completed">Completed</option>
          </select>
        </div>
        <button *ngIf="selectedFilter() !== 'all'"
                class="btn-text"
                (click)="filterApplications('all')">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
          Clear Filter
        </button>
      </div>
      <div class="filters-right">
        <span class="record-count">
          <strong>{{ filteredApplications().length }}</strong> application(s)
          <span *ngIf="selectedFilter() !== 'all'" class="filter-indicator">
            (filtered)
          </span>
        </span>
      </div>
    </div>

    <!-- Professional Data Table -->
    <app-data-table
      [data]="filteredApplications()"
      [columns]="tableColumns"
      [actions]="tableActions"
      [loading]="isLoading()"
      [config]="tableConfig"
      [showSerialNumber]="true">
    </app-data-table>
  </div>
</app-reviewer-layout>
