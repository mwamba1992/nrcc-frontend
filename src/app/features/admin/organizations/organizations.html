<app-reviewer-layout>
  <div class="organizations-container">
    <!-- Breadcrumb / Back Button -->
    <div class="breadcrumb-nav">
      <a routerLink="/admin/settings" class="back-link">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"/>
        </svg>
        Back to Settings
      </a>
    </div>

    <!-- Page Header -->
    <div class="page-header">
      <div class="header-content">
        <h1>Organizations Management</h1>
        <p class="subtitle">Manage organizations and their information</p>
      </div>
      <button class="btn-primary" (click)="openCreateModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        Add Organization
      </button>
    </div>

    <!-- Professional Data Table -->
    <app-data-table
      [data]="organizations()"
      [columns]="tableColumns"
      [actions]="tableActions"
      [loading]="isLoading()"
      [config]="tableConfig"
      [showSerialNumber]="true">
    </app-data-table>

    <!-- Modal for Create/Edit -->
    <div *ngIf="showModal()" class="modal-overlay" (click)="closeModal()">
      <div class="modal-content modal-large" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>{{ editMode() ? 'Edit Organization' : 'Add New Organization' }}</h2>
          <button class="btn-close" (click)="closeModal()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <form (ngSubmit)="submitForm()" class="modal-body">
          <div class="form-grid">
            <!-- Basic Information -->
            <div class="form-section">
              <h3 class="section-title">Basic Information</h3>

              <div class="form-group">
                <label for="code">Organization Code *</label>
                <input
                  type="text"
                  id="code"
                  [(ngModel)]="formData.code"
                  name="code"
                  placeholder="e.g., ORG001"
                  required
                  maxlength="20">
                <span class="help-text">Unique code for the organization</span>
              </div>

              <div class="form-group">
                <label for="name">Organization Name *</label>
                <input
                  type="text"
                  id="name"
                  [(ngModel)]="formData.name"
                  name="name"
                  placeholder="e.g., Dar es Salaam Municipal Council"
                  required>
              </div>

              <div class="form-group">
                <label for="organizationType">Organization Type *</label>
                <select
                  id="organizationType"
                  [(ngModel)]="formData.organizationType"
                  name="organizationType"
                  required>
                  <option value="" disabled>Select organization type</option>
                  <option *ngFor="let type of organizationTypes" [value]="type">
                    {{ formatOrganizationType(type) }}
                  </option>
                </select>
                <span class="help-text">Type of organization</span>
              </div>

              <div class="form-group">
                <label for="districtId">District</label>
                <select
                  id="districtId"
                  [(ngModel)]="formData.districtId"
                  name="districtId">
                  <option [value]="undefined">None</option>
                  <option *ngFor="let district of districts()" [value]="district.id">
                    {{ district.name }} ({{ district.regionName }})
                  </option>
                </select>
                <span class="help-text">Select the district this organization belongs to</span>
              </div>
            </div>

            <!-- Contact Information -->
            <div class="form-section">
              <h3 class="section-title">Contact Information</h3>

              <div class="form-group">
                <label for="contactPerson">Contact Person *</label>
                <input
                  type="text"
                  id="contactPerson"
                  [(ngModel)]="formData.contactPerson"
                  name="contactPerson"
                  placeholder="e.g., John Doe"
                  required>
              </div>

              <div class="form-group">
                <label for="email">Email *</label>
                <input
                  type="email"
                  id="email"
                  [(ngModel)]="formData.email"
                  name="email"
                  placeholder="e.g., contact@organization.go.tz"
                  required>
              </div>

              <div class="form-group">
                <label for="phoneNumber">Phone Number *</label>
                <input
                  type="tel"
                  id="phoneNumber"
                  [(ngModel)]="formData.phoneNumber"
                  name="phoneNumber"
                  placeholder="e.g., +255 123 456 789"
                  required>
              </div>

              <div class="form-group">
                <label for="address">Address</label>
                <textarea
                  id="address"
                  [(ngModel)]="formData.address"
                  name="address"
                  placeholder="Physical address"
                  rows="2"></textarea>
              </div>
            </div>
          </div>

          <!-- Full Width Description -->
          <div class="form-group">
            <label for="description">Description</label>
            <textarea
              id="description"
              [(ngModel)]="formData.description"
              name="description"
              placeholder="Brief description of the organization"
              rows="3"></textarea>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn-secondary" (click)="closeModal()">Cancel</button>
            <button type="submit" class="btn-primary">
              {{ editMode() ? 'Update' : 'Create' }} Organization
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</app-reviewer-layout>
